<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://binnes.github.io/esp8266Workshop/Simulator/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Index - ESP8266 IoT Workshop</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
            <div class="container">
                <a class="navbar-brand" href="..">ESP8266 IoT Workshop</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Part 1 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../part1/" class="dropdown-item">Intro</a>
</li>
                                    
<li>
    <a href="../part1/PREREQ/" class="dropdown-item">Setup for the Workshop</a>
</li>
                                    
<li>
    <a href="../part1/FIRSTAPP/" class="dropdown-item">Intro to ESP8266</a>
</li>
                                    
<li>
    <a href="../part1/WIFI/" class="dropdown-item">ESP8266 WiFi</a>
</li>
                                    
<li>
    <a href="../part1/LED/" class="dropdown-item">LED Light</a>
</li>
                                    
<li>
    <a href="../part1/DHT/" class="dropdown-item">Sensor</a>
</li>
                                    
<li>
    <a href="../part1/IOTCLOUD/" class="dropdown-item">IBM Cloud</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Part 2 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../part2/" class="dropdown-item">Intro</a>
</li>
                                    
<li>
    <a href="../part2/DEVICE/" class="dropdown-item">Device setup on Cloud</a>
</li>
                                    
<li>
    <a href="../part2/APP/" class="dropdown-item">Creating the ESP8266 Application</a>
</li>
                                    
<li>
    <a href="../part2/MQTT/" class="dropdown-item">Intro to MQTT</a>
</li>
                                    
<li>
    <a href="../part2/CERT1/" class="dropdown-item">IoT Security</a>
</li>
                                    
<li>
    <a href="../part2/CERT2/" class="dropdown-item">Client Certificates</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Part 3 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../part3/" class="dropdown-item">Intro</a>
</li>
                                    
<li>
    <a href="../part3/NODERED/" class="dropdown-item">Node-RED</a>
</li>
                                    
<li>
    <a href="../part3/DHTDATA/" class="dropdown-item">Sensor Data</a>
</li>
                                    
<li>
    <a href="../part3/DASHBOARD/" class="dropdown-item">Dashboards</a>
</li>
                                    
<li>
    <a href="../part3/CLOUDANT/" class="dropdown-item">Database</a>
</li>
                                    
<li>
    <a href="../part3/HISTORY/" class="dropdown-item">Historical Data</a>
</li>
                                    
<li>
    <a href="../part3/INTERVAL/" class="dropdown-item">Reporting interval</a>
</li>
                                    
<li>
    <a href="../part3/LED/" class="dropdown-item">Remote LED control</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Part 4 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../part4/" class="dropdown-item">Intro</a>
</li>
                                    
<li>
    <a href="../part4/STUDIO/" class="dropdown-item">Watson Studio</a>
</li>
                                    
<li>
    <a href="../part4/TRAINING/" class="dropdown-item">Create Training Data</a>
</li>
                                    
<li>
    <a href="../part4/JUPYTER/" class="dropdown-item">Jupyter Notebooks</a>
</li>
                                    
<li>
    <a href="../part4/MODEL/" class="dropdown-item">Run model on device</a>
</li>
                                    
<li>
    <a href="../part4/SUMMARY/" class="dropdown-item">Workshop Summary</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a href="https://github.com/binnes/esp8266Workshop/edit/master/docs/Simulator/README.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#the-watson-iot-platform-device-simulator" class="nav-link">The Watson IoT Platform Device Simulator</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#learning-objectives" class="nav-link">Learning objectives</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#prerequisites" class="nav-link">Prerequisites</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#estimated-time" class="nav-link">Estimated time</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#steps" class="nav-link">Steps</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#saving-simulation-configuration" class="nav-link">Saving simulation configuration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#limitations-of-the-device-simulator" class="nav-link">Limitations of the Device Simulator</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#summary" class="nav-link">Summary</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><em>Quick links :</em>
<a href="/README.md">Home</a> - <a href="../part1/">Part 1</a> - <a href="../part2/">Part 2</a> - <a href="../part3/">Part 3</a> - <a href="../part4/">Part 4</a></p>
<hr />
<h1 id="the-watson-iot-platform-device-simulator">The Watson IoT Platform Device Simulator</h1>
<p>The IBM Watson Internet of Things Platform contains a device simulator that can be used to post data without a real device being connected.  The simulator can be used to create data for multiple devices and device types, it can also post data for a real, registered device.</p>
<p>The simulator is useful for testing when a real device is not available or for testing conditions which are difficult to replicate using a real device, such as fault conditions.</p>
<h2 id="learning-objectives">Learning objectives</h2>
<p>After completing this guide you will be able to:</p>
<ul>
<li>Enable the device simulator in your instance of the Watson IoT Platform</li>
<li>Create simulated devices and be able to start and stop the devices</li>
<li>Generate the required data from the device simulators</li>
</ul>
<h2 id="prerequisites">Prerequisites</h2>
<p>Before working through this guide you should have a basic knowledge of the Watson Internet of Things platform and understand the relationship between devices and device types.  You also need to have an instance of the Watson IoT Platform deployed on the IBM Cloud.</p>
<p>You can find out about the Watson IoT Platform <a href="https://console.bluemix.net/docs/services/IoT/iotplatform_overview.html#about_iotplatform">here</a> and learn how to deploy an instance of the platform by following the guide <a href="https://developer.ibm.com/code/howtos/create-an-internet-of-things-starter-boilerplate">here</a>.</p>
<h2 id="estimated-time">Estimated time</h2>
<p>You can complete this task in no more than 20 minutes.</p>
<h2 id="steps">Steps</h2>
<p>Once you have your Internet of Things instance running, launch the Watson IoT Platform console.  To launch the console, select the service from your IBM Cloud dashboard then select the <strong>Launch</strong> button on the Watson IoT Platform service page.  Once the IoT console is open, complete the steps below:</p>
<h3 id="1-enable-the-device-simulator">1. Enable the Device Simulator</h3>
<p>By default, the device simulator is not enabled on the platform.  To enable it:</p>
<ol>
<li>Switch to the settings section of the Watson IoT Platform console.</li>
<li>Navigate to the <strong>Experimental Features</strong> settings area.</li>
<li>Enable the Device Simulator.</li>
</ol>
<p><img alt="Enable device simulator screenshot" src="images/enableSimulator.png" /></p>
<p>You should see the device simulator panel appear at the bottom of the IoT console.</p>
<p><img alt="Running simulator screenshot" src="images/runningSimulator.png" /></p>
<p>You can open the simulator by clicking on the panel and then close the simulator by using the twisty at the top of the simulator window</p>
<p><img alt="Close simulator screenshot" src="images/closeSimulator.png" /></p>
<h4 id="2-configuring-a-device-simulator">2. Configuring a Device Simulator</h4>
<p>Creating a simulator is a 2 part process:</p>
<ol>
<li>Create a simulation by selecting or create a device type and then model the data that should be posted when the simulation is running.</li>
<li>Create one or more device simulator instances for that simulation.</li>
</ol>
<p>To add your first simulation press the <strong>Add First Simulation</strong> button.  </p>
<p><img alt="First Simulation" src="images/firstSimulation.png" /></p>
<p>Clicking into the <strong>Select or create a device type...</strong> field will show any existing device types.  You can choose one of the existing device types or you can enter a device type name here to create a new device type.</p>
<p><img alt="selectDeviceType" src="images/selectDeviceType.png" /></p>
<p>Once the device type has been selected or created you are presented with the panel to configure the data for the simulation.  </p>
<p><img alt="Configure events" src="images/eventConfig.png" /></p>
<p>There are 3 areas, as shown in the image above:</p>
<h4 id="1-events">1. Events</h4>
<p>The simulator provides the ability to define multiple different events that a simulated device can publish.  E.g. if you have a device that sends temperature data every 30 seconds and air quality data every 10 minutes, then you could set up 2 events.  1 for the temperature and 1 for the air quality.</p>
<p>By default a single event is created when a new simulation is created, but additional events can be created using the <strong>+ New Event</strong> button**</p>
<p>Each event has its own schedule and payload content, but all events run when the simulation is running.  It is not possible to enable and disable individual events.  If you want that functionality then you need to create multiple simulations.</p>
<p>As you add more events the list of events grows.  You can expand and collapse the individual events using the twisty.</p>
<p><img alt="Multiple events" src="images/multipleEvents.png" /></p>
<h4 id="2-event-type-name">2. Event Type Name</h4>
<p>When data is sent from a device to the platform it is sent as a device event message with an event type as one of the fields in the message.  Here you can define the event type that will be sent with the payload for this event</p>
<h4 id="3-event-content-and-timing">3. Event Content and timing</h4>
<p>When you expand the section for an event you can specify how often a message is sent and what content is sent as the payload.</p>
<p>The schedule allows you to select a certain number of messages to be sent each minute or each hour.  The messages are sent at regular intervals, so 2 messages per minute will result in a messages being sent every 30 seconds.</p>
<p>The payload section allows you to define the message format that will be sent.  You can define a static message, where every message will have exactly the same content:</p>
<pre><code class="json">{
  &quot;sampleObject&quot;: {
    &quot;xcord&quot;: 32.514,
    &quot;ycord&quot;: 151.521
  }
}
</code></pre>

<p>or use one of the 2 options for adding variation to the data sent</p>
<ul>
<li>range(0,100), will generate a random number between the 2 parameters</li>
<li>$counter, will be contain the total number of devices added in the simulator for this type.</li>
</ul>
<pre><code class="json">{
  &quot;randomNumber&quot;: range(0, 100),
  &quot;total&quot; : $counter,
  &quot;sampleObject&quot;: {
    &quot;xcord&quot;: 32.514,
    &quot;ycord&quot;: 151.521
  }
}
</code></pre>

<p>When you have defined all the events, with the correct schedule and data content, press <strong>save</strong> to save the simulation.</p>
<h3 id="3-adding-simulated-devices">3. Adding simulated Devices</h3>
<p>Once you have the simulation defined you can create simulated devices for the simulation.  A device can be set to simulate an existing, configured, real device or register a new device on the platform.</p>
<p><img alt="Create Simulated Device" src="images/createSimulatedDevice.png" /></p>
<p>To add a device press the <strong>Create Simulated Device</strong> button or if you want to simulate an existing device press the <strong>Use Registered Device</strong> button (this will only be enabled if there is an available registered device of the correct deviceType to simulate).  Once the device is added then the simulated device will immediately start sending data according to the simulation settings.</p>
<p>You can add as many devices as you desire (up to the displayed limit)</p>
<p><img alt="Multiple Simulated Device" src="images/multipleDevices.png" /></p>
<p>You can control the simulation at the top level using the Device type controls or you can manage each device by expanding the device menu.</p>
<p><img alt="Control Simulated Device" src="images/controlDevices.png" /></p>
<p>Here you can start and stop individual devices, configure individual devices or delete a simulated device.  You are able to customise each device so they all differ from the simulation configuration.  However, if you modify the simulation configuration then you can choose to reset all devices back to the simulation configuration.</p>
<h3 id="4-monitoring-simulated-devices">4. Monitoring simulated devices</h3>
<p>You can see the state of simulated devices the same way you can monitor real devices using the devices section of the IoT console.</p>
<p><img alt="Monitor Simulated Device" src="images/monitorDevices.png" /></p>
<p>You can see when a simulator is active as it shows as a connected device, then expanding the device you can select the <strong>Recent Events</strong> section to see the individual events being received.</p>
<h2 id="saving-simulation-configuration">Saving simulation configuration</h2>
<p>The platform allows you to export your simulation configuration to the clipboard or download it as a JSON file.  You can then import a simulator configuration from the clipboard or file.  This allows you tp share a simulator configuration, so others can replication your simulator setup.</p>
<p><img alt="Import Export Simulator Configuration" src="images/importExportSimulation.png" /></p>
<p>When importing a device configuration the deviceType and devices are not automatically created, so you need to create them in advance or use the troubleshooting option to have the devices and deviceTypes created:</p>
<p>To open up the troubleshooting section click in the event info section at the bottom of the simulator panel:</p>
<p><img alt="Simulator Events summary" src="images/failingEvents.png" /></p>
<p>This will then show a log of events and offer to troubleshoot failing events:</p>
<p><img alt="Event Log" src="images/eventLog.png" /></p>
<p>Select the <strong>Troubleshoot</strong> button next to one of the failing events and you will have the option to diagnose the issue.  Press the <strong>Run Diagnostics</strong> button to get the simulator to determine the cause of the error:</p>
<p><img alt="Diagnose issue" src="images/runDiagnostics.png" /></p>
<p>The result of the diagnostics will be shown and if there are missing deviceTypes and devices the platform will offer to create the missing configuration:</p>
<p><img alt="Diagnose fix" src="images/diagnosticSolution.png" /></p>
<p>You can repeat this for all the devices imported to the simulator.</p>
<p>To clear the simulator event log, you can go into the settings panel and disable then enable the simulator.  The configuration will not be lost, but the simulator will be restarted, clearing the event log.</p>
<h2 id="limitations-of-the-device-simulator">Limitations of the Device Simulator</h2>
<p>The Simulator is still an experimental feature on the IoT Platform, so there are a few limitations.</p>
<ul>
<li>There is a limit to the number of concurrent simulated devices which can be run.  This is shown at the top of the simulation panel</li>
<li>You cannot have multiple simulations running concurrently for the same device.</li>
<li>The simulator will not work when user certificates have been added to the IoT platform configuration.  If you have certificates configured or even just uploaded then the simulator will fail to connect.  If you want to remove certificates, goto the settings section of your Watson IoT Platform console and follow the following steps:</li>
<li>Goto the <strong>Connection Security</strong> section then select <strong>Open Connection Security Policy</strong>.  Ensure no rules are configured to use certificates.  <strong>TLS with Token Authentication</strong> or <strong>TLS Optional</strong> should be selected for all rules.</li>
<li>Goto the <strong>Messaging Server Certificates</strong> section of the platform settings and ensure the Default Certificate is selected as the active certificate.  You can then select any imported certificates and then delete them.</li>
<li>Goto the <strong>CA Certificates</strong> section of the platform settings and delete any imported certificates.</li>
</ul>
<h2 id="summary">Summary</h2>
<p>This guide has shown you how to enable the device simulator and setup simulators to create device data.  The device simulator is a great tool to be able to test error or failure conditions that are difficult to create using live data from a real device.</p>
<p>Remember to turn off simulators when not needed to ensure you do not use up free limits on the IBM Cloud or incur additional expense if on a paid plan.</p>
<hr />
<p><em>Quick links :</em>
<a href="/README.md">Home</a> - <a href="../part1/">Part 1</a> - <a href="../part2/">Part 2</a> - <a href="../part3/">Part 3</a> - <a href="../part4/">Part 4</a></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
